ОТЧЕТ ПО ВЫПОЛНЕНИЮ ДОМАШНЕГО ЗАДАНИЯ HW05
"Линейные модели и честный ML-эксперимент"

Дата выполнения: 2024-12-22
Автор: [ФИО студента]
Курс: Инженерия Искусственного Интеллекта
Семинар: S05

1. ЦЕЛЬ РАБОТЫ
В данной работе был проведен полный ML-эксперимент по предсказанию 
дефолта по кредиту на синтетическом датасете. Основная цель - закрепить 
навыки работы с линейными моделями, построения бейзлайнов и проведения 
честного ML-эксперимента с корректной оценкой метрик качества.

2. ИСПОЛЬЗОВАННЫЕ ДАННЫЕ
- Датсет: S05-hw-dataset.csv (синтетические данные)
- Объем: 46 наблюдений, 17 признаков
- Целевая переменная: default (дефолт по кредиту: 0/1)
- Баланс классов: 52.2% не дефолт, 47.8% дефолт
- Признаки: возраст, доход, кредитный скоринг, стаж работы и другие 
  финансово-поведенческие характеристики

3. ВЫПОЛНЕННЫЕ ЭТАПЫ АНАЛИЗА
3.1. Первичный анализ данных:
   - Загрузка данных с относительным путем
   - Анализ структуры (head, info, describe)
   - Проверка пропущенных значений
   - Анализ распределения целевой переменной

3.2. Подготовка данных:
   - Выделение матрицы признаков X и таргета y
   - Исключение технического признака client_id
   - Все признаки числовые, дополнительная обработка не требовалась

3.3. Разделение данных:
   - Метод: train_test_split
   - Параметры: test_size=0.25, random_state=42, stratify=y
   - Результат: 34 объекта в train, 12 объектов в test
   - Сохранение баланса классов в обеих выборках

4. БЕЙЗЛАЙН МОДЕЛЬ (DummyClassifier)
4.1. Конфигурация:
   - Модель: DummyClassifier
   - Стратегии: 'most_frequent', 'stratified', 'uniform'
   - Лучшая стратегия: 'most_frequent' (предсказывает самый частый класс)

4.2. Результаты бейзлайна:
   - Accuracy: 0.5833
   - ROC-AUC: 0.5000 (случайный классификатор)
   - Вывод: Бейзлайн показывает accuracy, соответствующий доле 
     наиболее частого класса в данных (58.3%). Эта модель служит 
     важной точкой отсчета для оценки эффективности более сложных моделей.

5. ЛОГИСТИЧЕСКАЯ РЕГРЕССИЯ
5.1. Конфигурация:
   - Пайплайн: StandardScaler + LogisticRegression
   - Стандартизация признаков для улучшения сходимости
   - Параметры: max_iter=1000, random_state=42, solver='lbfgs'

5.2. Подбор гиперпараметров:
   - Метод: GridSearchCV с 5-кратной кросс-валидацией
   - Параметр для подбора: C (сила регуляризации)
   - Тестируемые значения: [0.001, 0.01, 0.1, 1, 10, 100]
   - Лучший параметр: C = 0.100
   - Метрика оптимизации: ROC-AUC

5.3. Результаты логистической регрессии:
   - Accuracy: 0.7500
   - ROC-AUC: 0.8524
   - Precision: 0.7143
   - Recall: 0.8333
   - F1-score: 0.7692
   - Матрица ошибок: [[5 1] [1 5]]

5.4. Графический анализ:
   - Построена ROC-кривая (AUC = 0.8524)
   - Построена Precision-Recall кривая (AP = 0.7857)
   - Все графики сохранены в папку figures/

6. СРАВНЕНИЕ МОДЕЛЕЙ
6.1. Основные метрики:
                     Бейзлайн   Логистическая регрессия   Улучшение
   Accuracy          0.5833     0.7500                    +28.6%
   ROC-AUC           0.5000     0.8524                    +70.5%
   Precision         0.0000     0.7143                    -
   Recall            0.0000     0.8333                    -
   F1-score          0.0000     0.7692                    -

6.2. Ключевые выводы по сравнению:
   - Логистическая регрессия значительно превосходит бейзлайн по всем метрикам
   - Наиболее значительное улучшение наблюдается в ROC-AUC (+70.5%)
   - Модель показывает хороший баланс между precision и recall

7. АНАЛИЗ ВЛИЯНИЯ ПАРАМЕТРОВ
7.1. Регуляризация (параметр C):
   - Оптимальное значение: C = 0.1
   - Меньшие значения C (0.001, 0.01): слишком сильная регуляризация, 
     ухудшение качества
   - Большие значения C (1, 10, 100): слабая регуляризация, 
     риск переобучения на малом объеме данных
   - Вывод: умеренная регуляризация (C=0.1) дает лучший результат 
     для данного датасета

7.2. Важность признаков (топ-5):
   1. credit_score: -0.892 (уменьшает вероятность дефолта)
   2. debt_to_income: 0.563 (увеличивает вероятность дефолта)
   3. num_late_payments: 0.401 (увеличивает вероятность дефолта)
   4. checking_balance: -0.321 (уменьшает вероятность дефолта)
   5. income: -0.298 (уменьшает вероятность дефолта)

8. ОГРАНИЧЕНИЯ И ПРЕДУПРЕЖДЕНИЯ
8.1. Ограничения данных:
   - Маленький объем выборки (46 наблюдений вместо ожидаемых ~3000)
   - Тестовая выборка содержит всего 12 объектов
   - Результаты могут быть нестабильными при изменении random_state

8.2. Методологические ограничения:
   - Не проводилась работа с выбросами и аномалиями
   - Не использовались техники feature engineering
   - Не проводилась калибровка вероятностей
   - Модель тестировалась только на одном разбиении данных

9. ВЫВОДЫ И РЕКОМЕНДАЦИИ
9.1. Основные выводы:
   1. Логистическая регрессия показала себя как эффективная модель для 
      задачи предсказания дефолта, значительно превзойдя бейзлайн
   2. Модель демонстрирует хороший баланс между точностью (accuracy) 
      и способностью различать классы (ROC-AUC)
   3. Наиболее важными признаками для прогноза являются кредитный скоринг, 
      отношение долга к доходу и количество просрочек платежей
   4. Умеренная регуляризация (C=0.1) дает оптимальный результат для 
      данного объема данных

9.2. Рекомендации для улучшения:
   1. Собрать больше данных для повышения стабильности оценок
   2. Провести более глубокий feature engineering
   3. Протестировать другие модели (Random Forest, Gradient Boosting)
   4. Использовать кросс-валидацию для более надежной оценки
   5. Учесть бизнес-стоимость ошибок при выборе порога классификации

9.3. Заключение:
Логистическая регрессия является разумным выбором для данной задачи 
предсказания дефолта. Модель показала хорошие результаты даже на 
ограниченном объеме данных. Однако для продакшн-системы необходимы 
дополнительные шаги по валидации и улучшению модели.

10. АРТЕФАКТЫ ЭКСПЕРИМЕНТА
Все артефакты эксперимента сохранены в структуре репозитория:
- homeworks/HW05/HW05.ipynb - основной ноутбук с анализом
- homeworks/HW05/figures/ - папка с графиками
- homeworks/HW05/artifacts/ - папка с дополнительными артефактами
- homeworks/HW05/report.txt - данный текстовый отчет

Эксперимент выполнен в полном соответствии с требованиями HW05.